function [ f, g ] = goldstein_price( x, pars )

% function [ f, g ] = goldstein_price( x )
% Created:     29.08.2020
% Last change: 29.08.2020

% The objective function:
% (1 + (x+y+1)^2 * (19-14*x+3*x^2-14*y+6*x*y+3*y^2) ) ...
%  * (30 + (2*x-3*y)^2*(18-32*x+12*x^2+48*y-36*x*y+27*y^2) )
f = (1 + (x(1)+x(2)+1)^2 * (19-14*x(1)+3*x(1)^2-14*x(2)+6*x(1)*x(2)+3*x(2)^2) ) ...
    * (30 + (2*x(1)-3*x(2))^2*(18-32*x(1)+12*x(1)^2+48*x(2)-36*x(1)*x(2)+27*x(2)^2) );
% Its gradient:
g = [ 24*(8*x(1)^3 - 4*x(1)^2*(9*x(2) + 4) + 6*x(1)*(9*x(2)^2 + 8*x(2) + 1) ...
    - 9*x(2)*(3*x(2)^2 + 4*x(2) + 1))*((3*x(1)^2 + 2*x(1)*(3*x(2) - 7) ...
    + 3*x(2)^2 - 14*x(2) + 19)*(x(1) + x(2) + 1)^2 + 1) + 12*(x(1)^3 + x(1)^2*(3*x(2) - 2) ...
    + x(1)*(3*x(2)^2 - 4*x(2) - 1) + x(2)^3 - 2*x(2)^2 - x(2) + 2)*((12*x(1)^2 - 4*x(1)*(9*x(2) + 8) ...
    + 3*(9*x(2)^2 + 16*x(2) + 6))*(2*x(1) - 3*x(2))^2 + 30);
    12*(x(1)^3 + x(1)^2*(3*x(2) - 2) + x(1)*(3*x(2)^2 - 4*x(2) - 1) ...
    + x(2)^3 - 2*x(2)^2 - x(2) + 2)*((12*x(1)^2 - 4*x(1)*(9*x(2) + 8) ...
    + 3*(9*x(2)^2 + 16*x(2) + 6))*(2*x(1) - 3*x(2))^2 + 30) - 36*(8*x(1)^3 ...
    - 4*x(1)^2*(9*x(2) + 4) + 6*x(1)*(9*x(2)^2 + 8*x(2) + 1) ...
    - 9*x(2)*(3*x(2)^2 + 4*x(2) + 1))*((3*x(1)^2 + 2*x(1)*(3*x(2) - 7) ...
    + 3*x(2)^2 - 14*x(2) + 19)*(x(1) + x(2) + 1)^2 + 1) ];

end